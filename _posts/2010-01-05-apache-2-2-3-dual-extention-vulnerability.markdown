--- 
wordpress_id: 802
layout: post
title: Apache 2.2.3 dual extention vulnerability
date: 2010-01-05 11:33:17 +00:00
tags: 
- php
- apache
- dual extension
- vulnerability
- "537535"
categories: 
- uncategorized
wordpress_url: http://saiweb.co.uk/uncategorized/apache-2-2-3-dual-extention-vulnerability
---
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=537535">Redhat bug 537535</a>

Take for instance this code saved as test.php.png

{% highlight php %}
<?PHP
print_r($_POST);
?>
{% endhighlight %}

Low and behold this will render out the entire post array! and will interpret the php itself, now lets be clear here the proper use of selinux and directory structures to prevent UGC from being allowed to be access directly and / or run arbitrary code would of prevented this, however as is often the case the setup is such that the preventative conditions could not / are not deployed.

At any rate this bug comes courtesy of the apache AddHandler directive, 

{% highlight bash %}
AddHandler x-httpd-php .php
{% endhighlight %}

The statement above seems to 'loose' match the .php extension meaning a file simply only contain .php anywhere in it's filename to be interpreted as PHP.

The suggested work around for this is as follows:

{% highlight bash %}
#Workaround for bug here: https://bugzilla.redhat.com/show_bug.cgi?id=537535
<FilesMatch \.php$>
SetHandler x-httpd-php
ForceType text/html
</FilesMatch>
{% endhighlight %}

Note this does not effect the AddType directive, after testing on the same version using:

{% highlight bash %}
AddType application/x-httpd-php .php
{% endhighlight %}

Is not effected by this 'bug'.




